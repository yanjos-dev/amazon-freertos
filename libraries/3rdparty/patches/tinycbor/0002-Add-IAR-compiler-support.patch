From f8d210274b95f7348cce5fe4e9739e5687063d9d Mon Sep 17 00:00:00 2001
From: Joshua Yan <52796499+yanjos-dev@users.noreply.github.com>
Date: Thu, 4 Jun 2020 14:31:30 -0700
Subject: [PATCH 2/5] Add IAR compiler support

This code is copied from the following repository:
https://github.com/ARMmbed/tinycbor/blob/master/src/compilersupport_p.h
---
 src/compilersupport_p.h | 17 +++++++++++++++++
 1 file changed, 17 insertions(+)

diff --git a/src/compilersupport_p.h b/src/compilersupport_p.h
index 2b9491d..f96b0b4 100644
--- a/src/compilersupport_p.h
+++ b/src/compilersupport_p.h
@@ -128,6 +128,23 @@
 #  define cbor_htonl        _byteswap_ulong
 #  define cbor_ntohs        _byteswap_ushort
 #  define cbor_htons        _byteswap_ushort
+#elif defined(__ICCARM__)
+#  if __LITTLE_ENDIAN__ == 1
+#    include <intrinsics.h>
+#    define ntohll(x)       ((__REV((uint32_t)(x)) * UINT64_C(0x100000000)) + (__REV((x) >> 32)))
+#    define htonll          ntohll
+#    define cbor_ntohl      __REV
+#    define cbor_htonl      __REV
+#    define cbor_ntohs      __REVSH
+#    define cbor_htons      __REVSH
+#  else
+#    define cbor_ntohll
+#    define cbor_htonll
+#    define cbor_ntohl
+#    define cbor_htonl
+#    define cbor_ntohs
+#    define cbor_htons
+#  endif
 #endif
 #ifndef cbor_ntohs
 #  include <arpa/inet.h>
-- 
2.22.0.windows.1

